@use 'sass:math';
@use 'sass:selector';
@use '../../styles/settings';
@use '../../styles/tools';
@use './variables' as *;

@include tools.layer('components') {
  .base-textarea {
    .base-field {
      --base-textarea-control-height: var(--base-input-control-height);
    }
    .base-field__field {
      --base-input-control-height: var(--base-textarea-control-height);
    }
    .base-field__input {
      $a: calc((var(--base-field-padding-top, 0) + var(--base-input-padding-top, 0)) - 6px);
      $b: calc((var(--base-field-padding-top, 0) + var(--base-input-padding-top, 0)) + 4px);

      flex: 1 1 auto;
      outline: none;
      -webkit-mask-image: linear-gradient(to bottom, transparent, transparent $a, black $b);
      mask-image: linear-gradient(to bottom, transparent, transparent $a, black $b);

      &.base-textarea__sizer {
        visibility: hidden;
        position: absolute;
        top: 0;
        left: 0;
        height: 0 !important;
        min-height: 0 !important;
        pointer-events: none;
      }
    }
    &--no-resize {
      .base-field__input {
        resize: none;
      }
    }
    .base-field--no-label,
    .base-field--active {
      textarea {
        opacity: 1;
      }
    }
    textarea {
      opacity: 0;
      flex: 1;
      min-width: 0;
      height: 100%;
      transition: .15s opacity settings.$standard-easing;

      &:focus,
      &:active {
        outline: none;
      }
      // Remove Firefox red outline
      &:invalid {
        box-shadow: none;
      }
    }
  }
}