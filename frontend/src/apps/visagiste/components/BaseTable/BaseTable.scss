@use "../../styles/tools";
@use "../../styles/settings";
@use "./variables" as *;
@use "./mixins" as *;

@include tools.layer('components') {
  // Theme
  .base-table {
    font-size: $table-font-size;
    transition-duration: $table-transition-duration;
    transition-property: $table-transition-property;
    transition-timing-function: $table-transition-timing-function;
    @include tools.theme($table-theme...);

    .base-table-divider {
      border-right: $table-border;
    }

    .base-table__wrapper {
      > table {
        > thead {
          > tr {
            > th {
              border-bottom: $table-border;
            }
          }
        }
        > tbody {
          > tr {
            &:not(:last-child) {
              > td,
              > th {
                border-bottom: $table-border;
              }
            }
          }
        }
        > tfoot {
          > tr {
            > td,
            > th {
              border-top: $table-border;
            }
          }
        }
      }
    }
    &.base-table--hover {
      > .base-table__wrapper {
        > table {
          > tbody {
            > tr {
              > td {
                position: relative;
              }
              &:hover > td::after {
                background: $table-hover-color;
                pointer-events: none;
                @include tools.absolute(true);
              }
            }
          }
        }
      }
    }
    &.base-table--fixed-header {
      > .base-table__wrapper {
        > table {
          > thead {
            > tr {
              > th {
                background: $table-background;
                box-shadow: inset 0 -1px 0 $table-border-color;
                z-index: 1;
              }
            }
          }
        }
      }
    }
    &.base-table--fixed-footer {
      > tfoot {
        > tr {
          > th,
          > td {
            background: $table-background;
            box-shadow: inset 0 1px 0 $table-border-color;
          }
        }
      }
    }
  }

  // Blocks
  .base-table {
    border-radius: inherit;
    // Do not inherit line-height
    line-height: $table-line-height;
    max-width: 100%;
    display: flex;
    flex-direction: column;

    > .base-table__wrapper {
      > table {
        width: 100%;
        border-spacing: 0;

        > tbody,
        > thead,
        > tfoot {
          > tr {
            > td,
            > th {
              padding: $table-column-padding;
              transition-duration: $table-transition-duration;
              transition-property: $table-transition-property;
              transition-timing-function: $table-transition-timing-function;
            }
            > td {
              height: var(--base-table-row-height);
            }
            > th {
              height: var(--base-table-header-height);
              font-weight: $table-header-font-weight;
              user-select: none;
              text-align: start;
            }
          }
        }
      }
    }
    @at-root {
      @include tools.density('base-table', $table-density) using ($modifier) {
        --base-table-header-height: #{$table-header-height + $modifier};
        --base-table-row-height: #{$table-row-height + $modifier};
      }
    }
  }

  // Elements
  .base-table__wrapper {
    border-radius: inherit;
    overflow: auto;
    flex: 1 1 auto;
  }

  // Modifiers
  .base-table--has-top {
    > .base-table__wrapper {
      > table {
        > tbody {
          > tr {
            &:first-child {
              &:hover {
                > td {
                  &:first-child {
                    border-top-left-radius: 0;
                  }
                  &:last-child {
                    border-top-right-radius: 0;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  .base-table--has-bottom {
    > .base-table__wrapper {
      > table {
        > tbody {
          > tr {
            &:last-child {
              &:hover {
                > td {
                  &:first-child {
                    border-bottom-left-radius: 0;
                  }
                  &:last-child {
                    border-bottom-right-radius: 0;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  .base-table--fixed-height {
    > .base-table__wrapper {
      overflow-y: auto;
    }
  }
  .base-table--fixed-header {
    > .base-table__wrapper {
      > table {
        > thead {
          position: sticky;
          top: 0;
          z-index: 2;
          > tr {
            > th {
              border-bottom: 0 !important;
            }
          }
        }
      }
    }
  }
  .base-table--fixed-footer {
    > .base-table__wrapper {
      > table {
        > tfoot {
          > tr {
            position: sticky;
            bottom: 0;
            z-index: 1;
            > td,
            > th {
              border-top: 0 !important;
            }
          }
        }
      }
    }
  }
}